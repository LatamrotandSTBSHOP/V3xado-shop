<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login Admin - LATAMROT</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div class="login-container">
        <h2>Panel Admin</h2>
        <input id="username" type="text" placeholder="Usuario">
        <input id="password" type="password" placeholder="Contraseña">
        <button onclick="login()">Entrar</button>
        <p id="msg" class="msg"></p>
    </div>

    <!-- Firebase -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getFirestore, collection, query, where, getDocs } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "TU_APIKEY",
            authDomain: "TU_AUTH_DOMAIN",
            projectId: "TU_PROJECT_ID",
            storageBucket: "TU_STORAGE_BUCKET",
            messagingSenderId: "TU_MSG_ID",
            appId: "TU_APP_ID"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        async function login() {
            const user = document.getElementById("username").value;
            const pass = document.getElementById("password").value;
            const msg = document.getElementById("msg");

            msg.innerText = "Verificando...";

            const q = query(collection(db, "usuarios"), where("username", "==", user));
            const result = await getDocs(q);

            if (result.empty) {
                msg.innerText = "Usuario no encontrado";
                return;
            }

            const data = result.docs[0].data();

            if (data.password !== pass) {
                msg.innerText = "Contraseña incorrecta";
                return;
            }

            if (data.rol !== "admin") {
                msg.innerText = "No tienes permisos de administrador";
                return;
            }

            // Guardar sesión
            localStorage.setItem("adminUser", user);

            // Redirigir
            window.location.href = "admin.html";
        }
    </script>

</body>
    </html>
